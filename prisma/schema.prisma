// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model App {
  id          String   @id @default(cuid())
  name        String
  platform    String   // "ios" or "android"
  country     String
  revenue     Float    @default(0)
  popularity  Int      @default(0) // Downloads or user count
  uaSpend     Float    @default(0) // User acquisition spend
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  metrics Metric[]
  queries Query[]

  @@map("apps")
}

model Metric {
  id          String   @id @default(cuid())
  appId       String
  date        DateTime
  metricType  String   // "revenue", "downloads", "ua_spend", etc.
  value       Float
  createdAt   DateTime @default(now())

  app App @relation(fields: [appId], references: [id], onDelete: Cascade)

  @@map("metrics")
}

model Query {
  id           String   @id @default(cuid())
  userId       String?
  appId        String?
  queryText    String
  sqlGenerated String
  result       String?
  timestamp    DateTime @default(now())

  app App? @relation(fields: [appId], references: [id], onDelete: SetNull)

  @@map("queries")
}
